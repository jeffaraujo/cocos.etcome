{"version":3,"sources":["assets\\Script\\Game.js"],"names":["cc","Class","extends","Component","properties","background","default","type","Node","btn_start","gameoverLayer","Layout","scoreLabel","Label","lifeLabel","pauseLabel","candies","Prefab","candyLayer","eat_candyAudio","url","AudioClip","splashAudio","tempomin","tempomax","score","maxLife","maxCandy","isLaunch","audioControl","onLoad","candiesCount","delta","self","scheduleOnce","initGame","node","on","event","addScore","audioEngine","playEffect","setContentSize","width","height","setPositionX","onPause","director","isPaused","resume","active","pause","gameOver","life","stopAllActions","removeAllChildren","string","spawCandy","dt","winsize","getContentSize","candiesAmount","length","candy","instantiate","Math","ceil","random0To1","setPosition","newCandyPosition","tempo","moveby","moveBy","sequence","removeSelf","callFunc","_candiesCount","runAction","addChild","x","y","p","newScore","toString","update"],"mappings":"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","file":"unknown","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        background: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        btn_start: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        gameoverLayer: {\r\n           default: null,\r\n           type: cc.Layout\r\n        },\r\n        scoreLabel: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        lifeLabel: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        pauseLabel: {\r\n          default: null,\r\n          type: cc.Label\r\n        },\r\n        candies: {\r\n          default: [],\r\n          type: cc.Prefab\r\n        },\r\n        candyLayer: {\r\n          default: null,\r\n          type: cc.Layout\r\n        },\r\n        eat_candyAudio: {\r\n          default: null,\r\n          url: cc.AudioClip\r\n        },\r\n        splashAudio: {\r\n          default: null,\r\n          url: cc.AudioClip\r\n        },\r\n        tempomin: 0,\r\n        tempomax: 0,\r\n        score: 0,\r\n        maxLife: 0,\r\n        maxCandy: 0,\r\n        isLaunch: false,\r\n        audioControl: true\r\n    },\r\n \r\n    // use this for initialization\r\n    onLoad: function () {\r\n        var candiesCount = 0;\r\n        var delta = 0;\r\n        \r\n        var self = this;\r\n        \r\n        self.scheduleOnce(function(){\r\n            this.candiesCount = 0;\r\n            self.initGame();\r\n        }, 1);\r\n        \r\n        self.node.on('candy_die', function(event){\r\n            \r\n            self.addScore(1);\r\n            candiesCount--;\r\n            if(self.audioControl === true){\r\n                cc.audioEngine.playEffect(self.eat_candyAudio, false);\r\n            }\r\n        }, self);\r\n        \r\n        this.candyLayer.node.setContentSize(this.background.width, this.background.height);\r\n        \r\n        this.btn_start.setPositionX(1000);\r\n    },\r\n    \r\n    onPause: function()\r\n    {\r\n       if(cc.director.isPaused()){\r\n           cc.director.resume();\r\n           this.pauseLabel.node.active = false;\r\n       }else{\r\n           cc.director.pause();\r\n           this.pauseLabel.node.active = true;\r\n       }\r\n    },\r\n    \r\n    gameOver: function()\r\n    {\r\n       if(this.life ===0 ){\r\n           this.isLaunch = false;\r\n           this.gameoverLayer.node.active = true;\r\n           \r\n           this.btn_start.setPositionX(0);\r\n           \r\n           this.candyLayer.node.stopAllActions();\r\n           this.candyLayer.node.removeAllChildren();\r\n           \r\n       }else{\r\n           if(this.audioControl === true){\r\n                cc.audioEngine.playEffect(this.splashAudio, false);\r\n           }\r\n           this.life--;\r\n           this.lifeLabel.string = \"x\" + this.life;\r\n       }\r\n    },\r\n    \r\n    initGame: function(){\r\n        this.life = this.maxLife;\r\n        \r\n        this.score = 0;\r\n        this.lifeLabel.string = \"x\" + this.life;\r\n        \r\n        this.isLaunch = true;\r\n    },\r\n\r\n    spawCandy: function(dt){\r\n      //var delta; \r\n        \r\n      if(this.isLaunch === false){\r\n          return;\r\n      }  \r\n      \r\n      if(this.candiesCount > this.maxCandy){\r\n          return;\r\n      }\r\n      \r\n      this.delta += dt;\r\n      if(this.delta < 1){\r\n          return;\r\n      }\r\n      \r\n      this.delta =0;\r\n      \r\n      var candyLayer = this.candyLayer.node;\r\n      \r\n      var winsize = candyLayer.getContentSize();\r\n      \r\n      var candiesAmount = this.candies.length - 1;\r\n      \r\n      //var candy = cc.instantiate(this.candies[0]);\r\n      var candy = cc.instantiate(this.candies[Math.ceil(candiesAmount * cc.random0To1())]);\r\n      \r\n      candy.setPosition(this.newCandyPosition());\r\n      \r\n      var tempo = cc.random0To1() * this.tempomax + this.tempomin;\r\n      \r\n      var self = this;\r\n      \r\n      var moveby = cc.moveBy(tempo, 0, -winsize.height-30);\r\n      \r\n      var sequence = cc.sequence(moveby, \r\n                                cc.removeSelf(true), \r\n                                cc.callFunc(function() {self._candiesCount--;}, self),\r\n                                cc.callFunc(function() {self.gameOver();}, self));\r\n      \r\n      candy.runAction(sequence);\r\n      \r\n      candyLayer.addChild(candy);\r\n      \r\n      this.candiesCount++;\r\n      \r\n    },\r\n\r\n    newCandyPosition: function(){\r\n        var winsize = this.candyLayer.node.getContentSize();\r\n        \r\n        var x = winsize.width * cc.random0To1();\r\n        \r\n        var y = winsize.height - 100;\r\n        \r\n        return cc.p(x, y);\r\n    },\r\n\r\n    addScore: function(newScore)\r\n    {\r\n      this.score += newScore;\r\n      \r\n      this.scoreLabel.string = this.score.toString();\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt){\r\n        this.spawCandy(dt);     \r\n    },\r\n});\r\n"]}